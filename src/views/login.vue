<template>
<div id="index" class="
      lang-en
      country-us
      currency-usd
      layout-full-width
      page-index
      tax-display-disabled
    ">
    <main>
        <Header :isHas="isHas" />
        <aside id="notifications">
            <div class="container"></div>
        </aside>
        <section id="wrapper" class="section-gap">
            <div class="container">
                <div id="columns_inner">
                    <div id="left-column" class="col-xs-12 col-sm-4 col-md-3 hb-animate-element top-to-bottom">

                        <div class="block-categories block">
                            <h4 class="block_title hidden-md-down">
                                <!--	<a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_category=6&controller=category&id_lang=1">Sweet Peas</a>-->
                                shop by category
                            </h4>
                            <h4 class="block_title hidden-lg-up" data-target="#block_categories_toggle" data-toggle="collapse">
                                <a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_category=6&amp;controller=category&amp;id_lang=1">Sweet Peas</a>
                                <span class="pull-xs-right">
                                    <span class="navbar-toggler collapse-icons">
                                        <i class="material-icons add"></i>
                                        <i class="material-icons remove"></i>
                                    </span>
                                </span>
                            </h4>
                            <div id="block_categories_toggle" class="block_content collapse">
                                <ul class="category-top-menu">
                                    <li>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div id="tmleftbanner" class="block">
                            <ul class="hidden-md-down">
                                <li class="slide tmleftbanner-container">
                                    <a href="#" title="LeftBanner 1">
                                        <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg" alt="LeftBanner 1" title="LeftBanner 1" src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg">
                                    </a>
                                </li>
                            </ul>
                            <div class="block hidden-lg-up">
                                <h4 class="block_title hidden-lg-up" data-target="#block_banner1_toggle" data-toggle="collapse">banner
                                    <span class="pull-xs-right">
                                        <span class="navbar-toggler collapse-icons">
                                            <i class="material-icons add"></i>
                                            <i class="material-icons remove"></i>
                                        </span>
                                    </span>
                                </h4>

                                <div class="col-md-12 col-xs-12 block_content collapse" id="block_banner1_toggle">

                                    <ul>
                                        <li class="slide tmleftbanner-container">
                                            <a href="#" title="LeftBanner 1">
                                                <img class="lazyload" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg" alt="LeftBanner 1" title="LeftBanner 1">
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="sidebar-latest block">
                            <h4 class="block_title hidden-md-down">New Products</h4>
                            <h4 class="block_title hidden-lg-up" data-target="#block_latest_toggle" data-toggle="collapse">New Products
                                <span class="pull-xs-right">
                                    <span class="navbar-toggler collapse-icons">
                                        <i class="material-icons add"></i>
                                        <i class="material-icons remove"></i>
                                    </span>
                                </span>
                            </h4>
                            <div class="block_content collapse" id="block_latest_toggle">
                                <div class="products clearfix">
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=21&amp;id_product_attribute=162&amp;rewrite=massa-suspendisse&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm" class="thumbnail product-thumbnail">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/8/118-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/8/118-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name"><a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=21&amp;id_product_attribute=162&amp;rewrite=massa-suspendisse&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm">Massa Suspendisse</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$33.25</span>

                                                    <span class="discount-percentage">-5%</span>
                                                    <span class="regular-price">$35.00</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=20&amp;id_product_attribute=118&amp;rewrite=varius-neque-at-enim&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm" class="thumbnail product-thumbnail">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/7/117-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/7/117-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name"><a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=20&amp;id_product_attribute=118&amp;rewrite=varius-neque-at-enim&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm">Vehicula Mauris Blandit</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$78.90</span>
                                                    <span class="regular-price">$78.90</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=19&amp;id_product_attribute=174&amp;rewrite=customizable-mug&amp;controller=product&amp;id_lang=1#/2-size-m/12-color-camel/19-dimension-40x60cm" class="thumbnail product-thumbnail">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/6/116-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/6/116-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name"><a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=19&amp;id_product_attribute=174&amp;rewrite=customizable-mug&amp;controller=product&amp;id_lang=1#/2-size-m/12-color-camel/19-dimension-40x60cm">Donec Semper Tristique</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$13.90</span>
                                                    <span class="regular-price">$13.90</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix">
                                    <a href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=new-products" class="allproducts btn btn-primary">All new products</a>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div id="breadcrumb_wrapper" class="left-column right-column col-sm-4 col-md-6">

                        <nav data-depth="1" class="breadcrumb hidden-sm-down">
                            <div class="container">
                                <h1 class="h1">
                                    Log in to your account
                                </h1>
                                <ol itemscope="" itemtype="http://schema.org/BreadcrumbList">

                                    <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
                                        <a itemprop="item" href="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php">
                                            <span itemprop="name">Home</span>
                                        </a>
                                        <meta itemprop="position" content="1">
                                    </li>

                                </ol>
                            </div>
                        </nav>

                    </div>
                    
                    <div id="content-wrapper" class="left-column col-xs-12 col-sm-8 col-md-9 text-center">

                        <section id="main">

                            <header class="page-header">

                            </header>

                            <section id="content" class="page-content card card-block">

                                <section class="login-form">

                                    <form id="login-form" action="https://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=authentication&amp;back=my-account" method="post">

                                        <section>

                                            <input type="hidden" name="back" value="my-account">

                                            <div class="form-group row ">
                                                <label class="col-md-3 form-control-label required">
                                                    Email
                                                </label>
                                                <div class="col-md-6">

                                                    <input class="form-control" v-model="username" name="email" type="email" value="" required="">

                                                </div>

                                                <div class="col-md-3 form-control-comment">

                                                </div>
                                            </div>

                                            <div class="form-group row ">
                                                <label class="col-md-3 form-control-label required">
                                                    Password
                                                </label>
                                                <div class="col-md-6">

                                                    <div class="input-group js-parent-focus">
                                                        <input v-model="password" class="form-control js-child-focus js-visible-password" name="password" title="At least 5 characters long" type="password" value="" pattern=".{5,}" required="">
                                                        <span class="input-group-btn">
                                                            <button class="btn" type="button" data-action="show-password" data-text-show="Show" data-text-hide="Hide">
                                                                Show
                                                            </button>
                                                        </span>
                                                    </div>

                                                </div>

                                                <div class="col-md-3 form-control-comment">

                                                </div>
                                            </div>

                                            <div class="forgot-password">
                                                 <router-link  :to="{ name: 'forget' }">
                                                    Forgot your password?
                                                </router-link>
                                            </div>
                                        </section>

                                        <footer class="form-footer text-xs-center clearfix">
                                            <input type="hidden" name="submitLogin" value="1">

                                            <button @click="login" id="submit-login" class="btn btn-primary" data-link-action="sign-in" type="submit">
                                                Sign in
                                            </button>

                                        </footer>

                                    </form>

                                </section>
                                <hr>

                                <div class="no-account">
                                    <router-link  :to="{ name: 'registration' }">
                                        No account? Create one here
                                    </router-link >
                                </div>

                            </section>

                            <footer class="page-footer">

                                <!-- Footer content -->

                            </footer>

                        </section>

                    </div>
                </div>
            </div>
        </section>

        <Footer></Footer>
    </main>
</div>
</template>

<script>
//import sidemenu from '@/components/sidemenu'
import Header from '@/components/navbar'
import Footer from '@/components/footer'
export default {
    components: {
        Header,
        Footer
    },
    data() {
        return {
            username: '',
            password: '',
            role: '',
            token: localStorage.getItem('token'),
            msg: []
        }
    },
    mounted() {
        // this.login()
        this.uid = localStorage.getItem('user')
        this.check()
        this.goToTop()
    },
    methods: {
        goToTop() {
            document.body.scrollTop = 0
            document.documentElement.scrollTop = 0
        },
        check() {
            if (this.uid != null) {
                window.location.href = 'myaccount';
            }
        },
        login() {
            var vi = this
            // console.log(this);
            const axios = require('axios')
            // alert("uid "+this.username+"--pass "+this.password);
            var ip_address = JSON.parse(localStorage.getItem('ip_address'))
            if (this.username === '') {
                this.$toasted.global.error({
                    message: 'Please enter username'
                })
            } else if (this.password === '') {
                this.$toasted.global.error({
                    message: 'Please enter password'
                })
            } else {
                // headers: this.$root.auth,
                axios({
                    method: 'POST',
                    url: this.$root.URL_ROOT + 'api.php',
                    data: {
                        type: 'userlogin',
                        username: this.username,
                        password: this.password,
                        ip_address: ip_address
                    }
                }).then(function (response) {
                    var data = response.data
                    console.log(response)
                    if (data.status === 'success') {
                        vi.token = data.body.access_token
                        vi.role = data.body.isAdmin
                        localStorage.setItem('user', data.body.id)
                        localStorage.setItem('token', data.body.access_tokens)
                        localStorage.setItem('isAdmin', data.body.role)
                        // vi.$router.go('/myaccount')
                        vi.$toasted.global.success({
                            message: 'Login Success Please wait...'
                        })
                        //vi.$router.push({ name: 'myaccount' });
                        window.location.href = 'myaccount';
                    } else {
                        vi.$toasted.global.error({
                            message: 'Invalid id or password'
                        })
                    }
                })
            }
            return false
        }
    }
}
</script>
