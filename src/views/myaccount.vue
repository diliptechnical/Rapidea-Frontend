<template>
<div id="index" class="
      lang-en
      country-us
      currency-usd
      layout-full-width
      page-index
      tax-display-disabled
    ">
    <main>
        <Header :isHas="isHas" />
        <aside id="notifications">
            <div class="container"></div>
        </aside>
        <section id="wrapper" class="section-gap">

            <div class="container">
                <div id="columns_inner">
                    <div id="left-column" class="col-xs-12 col-sm-4 col-md-3 hb-animate-element top-to-bottom">

                        <div class="block-categories block">
                            <h4 class="block_title hidden-md-down">
                                <!--	<a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_category=6&controller=category&id_lang=1">Sweet Peas</a>-->
                                shop by category
                            </h4>
                            <h4 class="block_title hidden-lg-up" data-target="#block_categories_toggle" data-toggle="collapse">
                                <a href="#">Sweet Peas</a>
                                <span class="pull-xs-right">
                                    <span class="navbar-toggler collapse-icons">
                                        <i class="material-icons add"></i>
                                        <i class="material-icons remove"></i>
                                    </span>
                                </span>
                            </h4>
                            <div id="block_categories_toggle" class="block_content collapse">
                                <ul class="category-top-menu">
                                    <li>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div id="tmleftbanner" class="block">
                            <ul class="hidden-md-down">
                                <li class="slide tmleftbanner-container">
                                    <a href="#" title="LeftBanner 1">
                                        <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg" alt="LeftBanner 1" title="LeftBanner 1" src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg">
                                    </a>
                                </li>
                            </ul>
                            <div class="block hidden-lg-up">
                                <h4 class="block_title hidden-lg-up" data-target="#block_banner1_toggle" data-toggle="collapse">banner
                                    <span class="pull-xs-right">
                                        <span class="navbar-toggler collapse-icons">
                                            <i class="material-icons add"></i>
                                            <i class="material-icons remove"></i>
                                        </span>
                                    </span>
                                </h4>

                                <div class="col-md-12 col-xs-12 block_content collapse" id="block_banner1_toggle">

                                    <ul>
                                        <li class="slide tmleftbanner-container">
                                            <a href="#" title="LeftBanner 1">
                                                <img class="lazyload" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/modules/tm_leftbanner/views/img/left-banner-1.jpg" alt="LeftBanner 1" title="LeftBanner 1">
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="sidebar-latest block">
                            <h4 class="block_title hidden-md-down">New Products</h4>
                            <h4 class="block_title hidden-lg-up" data-target="#block_latest_toggle" data-toggle="collapse">New Products
                                <span class="pull-xs-right">
                                    <span class="navbar-toggler collapse-icons">
                                        <i class="material-icons add"></i>
                                        <i class="material-icons remove"></i>
                                    </span>
                                </span>
                            </h4>
                            <div class="block_content collapse" id="block_latest_toggle">
                                <div class="products clearfix">
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a href="#">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/8/118-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/8/118-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name">
                                                  <a href="#">Massa Suspendisse</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$35.00</span>
                                                    <span class="regular-price">$35.00</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=20&amp;id_product_attribute=118&amp;rewrite=varius-neque-at-enim&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm" class="thumbnail product-thumbnail">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/7/117-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/7/117-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name"><a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=20&amp;id_product_attribute=118&amp;rewrite=varius-neque-at-enim&amp;controller=product&amp;id_lang=1#/1-size-s/5-color-grey/19-dimension-40x60cm">Vehicula Mauris Blandit</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$78.90</span>
                                                    <span class="regular-price">$78.90</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="product-item">
                                        <div class="left-part">

                                            <a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=19&amp;id_product_attribute=174&amp;rewrite=customizable-mug&amp;controller=product&amp;id_lang=1#/2-size-m/12-color-camel/19-dimension-40x60cm" class="thumbnail product-thumbnail">
                                                <img class=" ls-is-cached lazyloaded" data-src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/6/116-cart_default.jpg" alt="" src="https://prestashop.templatemela.com/PRSADD12/PRS295/img/p/1/1/6/116-cart_default.jpg">
                                            </a>

                                        </div>

                                        <div class="right-part">
                                            <div class="product-description">

                                                <span class="h3 product-title" itemprop="name"><a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?id_product=19&amp;id_product_attribute=174&amp;rewrite=customizable-mug&amp;controller=product&amp;id_lang=1#/2-size-m/12-color-camel/19-dimension-40x60cm">Donec Semper Tristique</a></span>

                                                <div class="product-price-and-shipping">

                                                    <span itemprop="price" class="price">$13.90</span>
                                                    <span class="regular-price">$13.90</span>

                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix">
                                    <a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=new-products" class="allproducts btn btn-primary">All new products</a>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="breadcrumb_wrapper" class="left-column right-column col-sm-4 col-md-6">

                        <nav data-depth="1" class="breadcrumb hidden-sm-down">
                            <div class="container">
                                <h1 class="h1">
                                    Your account
                                </h1>
                                <ol itemscope="" itemtype="http://schema.org/BreadcrumbList">

                                    <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
                                        <a itemprop="item" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php">
                                            <span itemprop="name">Home</span>
                                        </a>
                                        <meta itemprop="position" content="1">
                                    </li>

                                </ol>
                            </div>
                        </nav>

                    </div>

                    <div id="content-wrapper" class="left-column col-xs-12 col-sm-8 col-md-9">

                        <section id="main">

                            <header class="page-header">

                            </header>

                            <section id="content" class="page-content">

                                <aside id="notifications">
                                    <div class="container">

                                    </div>
                                </aside>

                                <div class="row">
                                    <div class="links">

                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="identity-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=identity">
                                            <span class="link-item">
                                                <i class="material-icons"></i>
                                                Information
                                            </span>
                                        </a>

                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="address-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=address">
                                            <span class="link-item">
                                                <i class="material-icons"></i>
                                                Add first address
                                            </span>
                                        </a>

                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="history-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=history">
                                            <span class="link-item">
                                                <i class="material-icons"></i>
                                                Order history and details
                                            </span>
                                        </a>

                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="order-slips-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?controller=order-slip">
                                            <span class="link-item">
                                                <i class="material-icons"></i>
                                                Credit slips
                                            </span>
                                        </a>

                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="identity-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?fc=module&amp;module=psgdpr&amp;controller=gdpr&amp;id_lang=1">
                                            <span class="link-item">
                                                <i class="material-icons">account_box</i> GDPR - Personal data
                                            </span>
                                        </a>
                                        <a class="col-lg-4 col-md-6 col-sm-6 col-xs-12" id="mywishlist-link" data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?fc=module&amp;module=stfeature&amp;controller=mywishlist&amp;id_lang=1">
                                            <span class="link-item">
                                                <i class="material-icons"></i>
                                                My Wishlist
                                            </span>
                                        </a>

                                    </div>
                                </div>

                            </section>

                            <footer class="page-footer">

                                <div class="text-xs-center">
                                    <a data-id="#://prestashop.templatemela.com/PRSADD12/PRS295/index.php?mylogout=" class="btn btn-primary">
                                        Sign out
                                    </a>
                                </div>

                            </footer>

                        </section>

                    </div>

                </div>
            </div>
        </section>
        <Footer></Footer>
    </main>
</div>
</template>

<script>
// import sidemenu from '@/components/sidemenu'
import Header from '@/components/navbar'
import Footer from '@/components/footer'
import axios from 'axios'
import Toasted from 'vue-toasted';
import Vue from 'vue'
Vue.use(Toasted)

export default {
    name: 'Detail',
    components: {
        Header,
        Footer,
    },

    data() {
        return {
            categories: [],
            userAdd: [],
            products: [],
            ip_address: JSON.parse(localStorage.getItem('ip_address')),
            uid: localStorage.getItem('user'),
            chk_cat: false,
            chk_pro: false,
            userdetail: [],
            uname: '',
            stateData: [],
            addressDatas: [],

            dashboard_box: 'info',
            orderDetailData: [],
            fname: '',
            lname: '',
            email: '',
            mobile: '',
            opass: '',
            npass: '',
            cpass: '',
            c_state: '',
            city: '',
            address_name: '',
            address_mobile: '',
            add1: '',
            add2: '',
            zipcode: '',
            mobile_no: '',
            address_state: '',
            address_city: '',
            pincode: '',

        }
    },
    mounted() {

        this.getUserDetail();
        this.getState();
        this.getAddress();
        this.orderDetail()
        this.goToTop()
    },
    methods: {
        goToTop() {
            document.body.scrollTop = 0
            document.documentElement.scrollTop = 0
        },
        open_dashboard(vl) {
            // console.log('asdfghjklsdfghjk'+vl)
            this.dashboard_box = vl;
        },

        getUserDetail() {
            var self = this
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'getUserDetail',
                    uid: this.uid
                }
            }).then(function (response) {
                var data = response.data
                self.userdetail = data

                self.fname = data.fname;
                self.lname = data.lname;
                self.email = data.email;
                self.mobile = data.mobile;
                self.uname = data.fullname;

                console.log("UgetUserDetail");
                console.log(data)

            })

        },
        change_info() {

            var ev = this;
            //var newpass=''
            var flag = 0;

            if (this.opass != "" || this.npass != "" || this.cpass != '') {

                if (this.opass == "") {
                    ev.$toasted.global.error({
                        message: 'please enter old password '
                    })
                    flag = 1;
                } else if (this.npass == "") {
                    ev.$toasted.global.error({
                        message: 'please enter new password '
                    })
                    flag = 1;

                } else if (this.cpass == "") {
                    ev.$toasted.global.error({
                        message: 'please enter re-password '
                    })
                    flag = 1;
                } else if (this.npass != this.cpass) {
                    ev.$toasted.global.error({
                        message: 'password not match'
                    })
                    flag = 1;
                } else {

                    //newpass=ev.npass;
                    flag = 2;
                }

            } else {
                flag = 2;
            }
            if (flag == 2) {

                axios({
                    method: 'POST',
                    url: this.$root.URL_ROOT + 'api.php',
                    data: {
                        type: 'change_info',
                        uid: ev.uid,
                        fname: ev.fname,
                        lname: ev.lname,
                        email: ev.email,
                        mobile: ev.mobile,
                        npass: ev.npass,
                        opass: ev.opass,

                    }
                }).then(function (response) {

                    var data = response.data
                    //self.categories = data
                    console.log(data);

                    if (data.status == "success") {
                        ev.opass = "";
                        ev.npass = "";
                        ev.cpass = "";

                        ev.uname = ev.fname + ' ' + ev.lname;

                        ev.$toasted.global.success({
                            message: data.msg
                        })
                    } else {

                        ev.$toasted.global.success({
                            message: data.msg
                        })
                    }
                })

            }

        },

        getState() {

            var ev = this;
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'getState',

                }
            }).then(function (response) {

                var data = response.data
                ev.stateData = data

            })

        },
        orderDetail() {

            var ev = this;
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'getMyOrders',
                    uid: ev.uid,

                }
            }).then(function (response) {

                var data = response.data
                ev.orderDetailData = data
                console.log('fvsssssssssssss')
                console.log(response)

            })

        },

        getAddress() {
            var ev = this;
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'getAddress',
                    uid: ev.uid,
                    ip_address: ev.ip_address
                }
            }).then(function (response) {
                var data = response.data
                ev.userAdd = response.user
                ev.addressDatas = data.data
                // console.log('dilip')
                // console.log(response.user);

            })

        },
        saveAdd(id) {
            var ev = this;
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'updateAddress',
                    id: id,
                    uid: ev.uid,
                    ip_address: ev.ip_address,
                    fname: ev.fname,
                    lname: ev.lname,
                    add1: ev.add1,
                    add2: ev.add2,
                    city: ev.city,
                    mobile_no: ev.mobile_no,
                    c_state: ev.c_state,
                    zipcode: ev.zipcode
                }
            }).then(function (response) {
                var data = response.data
                if (data.status == "success") {
                    ev.$toasted.global.success({
                        message: data.msg
                    })
                }
                ev.getAddress()

            })
        },
        deleteAdd(id) {
            var ev = this;
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'deleteAdd',
                    id: id,
                }
            }).then(function (response) {
                var data = response.data
                // console.log(response)
                ev.getAddress()
                if (data.status == "success") {
                    ev.$toasted.global.success({
                        message: data.msg
                    })
                }
            })
        },
        editAddress(id) {
            var ev = this;
            this.open_dashboard('editAdd')
            axios({
                method: 'POST',
                url: this.$root.URL_ROOT + 'api.php',
                data: {
                    type: 'editAddress',
                    id: id,
                    uid: ev.uid,
                    ip_address: ev.ip_address,
                }
            }).then(function (response) {
                var data = response.data
                ev.editadd = data.data
                //console.log('adddilip')
                //console.log(response.data.data);
                ev.fname = ev.editadd.fname
                ev.lname = ev.editadd.lname
                ev.add1 = ev.editadd.add1
                ev.add2 = ev.editadd.add2
                ev.city = ev.editadd.city
                ev.mobile_no = ev.editadd.mobile_no
                ev.c_state = ev.editadd.c_state
                ev.zipcode = ev.editadd.zipcode
                ev.add_id = ev.editadd.add_id

            })

        },

        save_address() {

            var ev = this;

            if (this.address_name == "") {
                ev.$toasted.global.error({
                    message: 'please enter address title '
                })

            } else if (this.address_mobile == "") {
                ev.$toasted.global.error({
                    message: 'please enter mobile number '
                })

            } else if (this.add1 == "") {
                ev.$toasted.global.error({
                    message: 'please enter address 1 '
                })

            } else if (this.add2 == "") {
                ev.$toasted.global.error({
                    message: 'please enter address 2 '
                })

            } else if (this.address_city == "") {
                ev.$toasted.global.error({
                    message: 'please enter city '
                })

            } else if (this.address_state == "") {
                ev.$toasted.global.error({
                    message: 'please select state '
                })

            } else {

                axios({
                    method: 'POST',
                    url: this.$root.URL_ROOT + 'api.php',
                    data: {
                        type: 'save_address',
                        uid: ev.uid,
                        address_name: ev.address_name,
                        address_mobile: ev.address_mobile,
                        add1: ev.add1,
                        add2: ev.add2,
                        pincode: ev.pincode,
                        address_state: ev.address_state

                    }
                }).then(function (response) {

                    var data = response.data
                    //ev.stateData=data 
                    console.log(response);
                    if (data.status == "success") {
                        ev.$toasted.global.success({
                            message: data.msg
                        })
                        ev.$refs.fileInput.click()
                        ev.getAddress();
                    }
                })

            }

        }

    }

}
</script>
